---
layout: post
title:  Kerberos protocol operation
date:   2014-09-10 05:00:00
description: The authentication protocol Kerberos allows a number of computers to prove their identity among them safely over an insecure network. The operation of the protocol is based on the Needham-Schroeder protocol, which defines a ''trusted third party'' called Key Distribution Center (KDC). 
tags: kerberos security
categories: Security
---
<p>
<span style="font-size:14px;"><span style="font-family:arial,helvetica,sans-serif;"><strong>The authentication protocol Kerberos allows a number of computers to prove their identity among them safely over an insecure network</strong>. The operation of the protocol is based on the Needham-Schroeder protocol, which defines a &#39;&#39;trusted third party&#39;&#39; called Key Distribution Center (KDC). William Stallings in his book Fundamentals of Network Security: Applications and Standards, Second Edition (p.394) defines a KDC as follows:</span></span></p>
<blockquote>
<p>
<span style="font-family: arial, helvetica, sans-serif; font-size: 14px;">Authorized system to transmit temporary session key for users. Each session key is transmitted encrypted using a master key that the Key Distribution Center shares with the target user.</span></p>
</blockquote>
<p>
<span style="font-family: arial, helvetica, sans-serif; font-size: 14px;"><strong>The KDC can be seen as a set of two logic stages: an authentication server (AS) and an ticket granting server (TGS)</strong>. The AS has the function to identify each user, validate their identity and give the client a key that allows to communicate with the TGS. Furthermore, the TGS is the responsible server for checking that the client possesses the authentication ticket and provides a key to the user that allows access to the requested services. This scenario is shown in <strong><span style="color:#0000ff;">Figure # 1</span></strong>.</span></p>
<p>
&nbsp;</p>
<p>
&nbsp;</p>
<p style="text-align: center;">
<img alt="" src="images/TICs/funcionamiento-protocolo-kerberos/1.png" style="height: 470px; width: 500px;" /></p>
<p style="text-align: center;">
<strong style="font-family: arial, helvetica, sans-serif; font-size: 14px;"><span style="color:#0000ff;">Figure </span></strong><strong style="font-family: arial, helvetica, sans-serif; font-size: 14px;"><span style="color:#0000ff;">#</span></strong><strong style="font-family: arial, helvetica, sans-serif; font-size: 14px;"><span style="color:#0000ff;"> 1</span></strong><span style="font-family: arial, helvetica, sans-serif; font-size: 14px;">: Components and communication flow of Kerberos protocol.</span></p>

<p>
<span style="font-family: arial, helvetica, sans-serif; font-size: 14px;">Kerberos performs a ticket management that allows users to prove their identity and get the keys for a particular service, these keys allow to two entities interact safely. This requires that the protocol perform a proper management of different databases in order to identify users, while maintaining another database of secret keys to assign to each entity, either client or server.</span></p>
<p>
<span style="font-family: arial, helvetica, sans-serif; font-size: 14px;"><span style="color:#0000ff;"><strong>Figure # 2 </strong></span>shows the produced messages flow by the Kerberos protocol, which clearly sees the contained information in each sent message between the different entities involved in the key exchange. It should be clarified that the previous communication that should be established between the client and the AS, which gives the user name and password entered by the user on the client, is not shown. However, the ticket management is quite clear.</span></p>
<p>
<span style="font-family: arial, helvetica, sans-serif; font-size: 14px;">When the client makes a request to the AS, the AS responds with two messages: <strong>the first sends the encrypted key that the client will share with the TGS, and the second packet should be forwarded to the TGS</strong>, this package cannot be decrypted by the client and contains information about the validation made by the AS.</span></p>
<p>
<span style="font-family: arial, helvetica, sans-serif; font-size: 14px;">Then, the client sends two messages to the TGS: <strong>in the first message forwards the packet that has been received from the AS, adding the type of the requested service and the second message is an authenticator </strong>which is encrypted with the key generated by the AS for the communication between client and TGS.</span></p>
<p>
<span style="font-family: arial, helvetica, sans-serif; font-size: 14px;">Now, the TGS responds to the client with the key that will be sharing with the requested service server and a ticket that only this server can decrypt and that the customer must forward. The client forwards the ticket to the service server and also an authenticator encrypted with the provided key by the TGS for the communication, so that, the communication between client and service can be performed in encrypted form with that key.</span></p>
<p>
&nbsp;</p>
<p style="text-align: center;">
<img alt="" src="images/TICs/funcionamiento-protocolo-kerberos/2.png" style="height: 400px; width: 500px;" /></p>
<p style="text-align: center;">
<span style="font-family: arial, helvetica, sans-serif; font-size: 14px; color: rgb(0, 0, 255);"><strong>Figure # 2</strong></span><span style="font-family: arial, helvetica, sans-serif; font-size: 14px;">: Message Exchange of the Kerberos protocol.</span></p>
<p style="text-align: center;">
&nbsp;</p>
<h1>
<span style="font-size:14px;"><span style="font-family:arial,helvetica,sans-serif;">References</span></span></h1>
<ol>
<li>
<span style="font-family: arial, helvetica, sans-serif; font-size: 14px;">William Stallings. Fundamentals of Network Security: Applications and Standards, Second Edition. Pearson Education. 2004.</span></li>
</ol>
<p>
&nbsp;</p>